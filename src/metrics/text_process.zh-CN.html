

<!DOCTYPE html>
<html class="writer-html5" lang="zh-CN" data-content_root="../../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>文本数据处理 &mdash; Open-DataFlow-Eval 0.1 文档</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="../../_static/css/theme.css?v=e59714d7" />

  
      <script src="../../_static/jquery.js?v=5d32c60e"></script>
      <script src="../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../../_static/documentation_options.js?v=7c91f8fd"></script>
      <script src="../../_static/doctools.js?v=9bcbadda"></script>
      <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
      <script src="../../_static/translations.js?v=beaddf03"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="索引" href="../../genindex.html" />
    <link rel="search" title="搜索" href="../../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../index.html" class="icon icon-home">
            Open-DataFlow-Eval
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="搜索文档" aria-label="搜索文档" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="导航菜单">
              <p class="caption" role="heading"><span class="caption-text">Open-DataFlow-Eval:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../getting_started/index.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="index.html">Metrics</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="移动版导航菜单" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">Open-DataFlow-Eval</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="页面导航">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">文本数据处理</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../_sources/src/metrics/text_process.zh-CN.md.txt" rel="nofollow"> 查看页面源码</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="id1">
<h1>文本数据处理<a class="headerlink" href="#id1" title="Link to this heading"></a></h1>
<section id="id2">
<h2>概览<a class="headerlink" href="#id2" title="Link to this heading"></a></h2>
<p>DataFlow目前支持的文本数据处理主要针对于数据点层面，可以分为以下三种类型，分别是数据改写器、数据去重器和数据过滤器。</p>
<table class="tg">
  <thead>
    <tr>
      <th class="tg-0pky">类型</th>
      <th class="tg-0pky">数量</th>
      <th class="tg-0pky">描述</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td class="tg-0pky">数据改写器</td>
      <td class="tg-0pky">15</td>
      <td class="tg-0pky">通过数据处理、数据增强等方式改善数据点内容（不改变总数量）</td>
    </tr>
    <tr>
      <td class="tg-0pky">数据去重器</td>
      <td class="tg-0pky">6</td>
      <td class="tg-0pky">通过哈希等方法进行数据点去重</td>
    </tr>
    <tr>
      <td class="tg-0pky">数据过滤器</td>
      <td class="tg-0pky">42</td>
      <td class="tg-0pky">通过设置阈值等方式过滤数据点</td>
    </tr>
  </tbody>
</table>
</section>
<section id="id3">
<h2>数据改写器<a class="headerlink" href="#id3" title="Link to this heading"></a></h2>
<table class="tg">
  <thead>
    <tr>
      <th class="tg-0pky">名称</th>
      <th class="tg-0pky">适用类型</th>
      <th class="tg-0pky">简介</th>
      <th class="tg-0pky">官方仓库或论文</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td class="tg-0pky">LowercaseRefiner</td>
      <td class="tg-0pky">NLP</td>
      <td class="tg-0pky">将文本字段中的内容转换为小写</td>
      <td class="tg-0pky">-</td>
    </tr>
    <tr>
      <td class="tg-0pky">PIIAnonymizeRefiner</td>
      <td class="tg-0pky">预训练</td>
      <td class="tg-0pky">通过识别和匿名化个人身份信息（PII），如姓名、位置等，来保护隐私</td>
      <td class="tg-0pky"><a href="https://github.com/microsoft/presidio">Code</a></td>
    </tr>
    <tr>
      <td class="tg-0pky">RemovePunctuationRefiner</td>
      <td class="tg-0pky">NLP</td>
      <td class="tg-0pky">移除文本中的标点符号</td>
      <td class="tg-0pky">-</td>
    </tr>
    <tr>
      <td class="tg-0pky">RemoveNumberRefiner</td>
      <td class="tg-0pky">NLP</td>
      <td class="tg-0pky">移除文本中的数字字符</td>
      <td class="tg-0pky">-</td>
    </tr>
    <tr>
      <td class="tg-0pky">RemoveExtraSpacesRefiner</td>
      <td class="tg-0pky">NLP、预训练</td>
      <td class="tg-0pky">移除文本中的多余空格，将连续的多个空格替换为单个空格，并去除文本前后空格</td>
      <td class="tg-0pky">-</td>
    </tr>
    <tr>
      <td class="tg-0pky">RemoveRepetitionsPunctuationRefiner</td>
      <td class="tg-0pky">NLP</td>
      <td class="tg-0pky">移除重复的标点符号，例如“!!!”变为“!”</td>
      <td class="tg-0pky">-</td>
    </tr>
    <tr>
      <td class="tg-0pky">RemoveEmojiRefiner</td>
      <td class="tg-0pky">预训练</td>
      <td class="tg-0pky">移除文本中的表情符号，例如"😀"</td>
      <td class="tg-0pky"><a href="https://gist.github.com/slowkow/7a7f61f495e3dbb7e3d767f97bd7304b">Code</a></td>
    </tr>
    <tr>
      <td class="tg-0pky">RemoveEmoticonsRefiner</td>
      <td class="tg-0pky">预训练</td>
      <td class="tg-0pky">移除文本中的表情符号，例如“:‑)”，使用预定义的表情符号列表</td>
      <td class="tg-0pky"><a href="https://github.com/NeelShah18/emot/blob/master/emot/emo_unicode.py">Code</a></td>
    </tr>
    <tr>
      <td class="tg-0pky">RemoveContractionsRefiner</td>
      <td class="tg-0pky">NLP</td>
      <td class="tg-0pky">扩展文本中的缩写词（例如将“can't”扩展为“cannot”）</td>
      <td class="tg-0pky"><a href="https://github.com/kootenpv/contractions">Code</a></td>
    </tr>
    <tr>
      <td class="tg-0pky">HtmlUrlRemoverRefiner</td>
      <td class="tg-0pky">预训练</td>
      <td class="tg-0pky">移除文本中的URL和HTML标签</td>
      <td class="tg-0pky">-</td>
    </tr>
    <tr>
      <td class="tg-0pky">TextNormalizationRefiner</td>
      <td class="tg-0pky">NLP</td>
      <td class="tg-0pky">规范化文本中的日期格式、货币格式等</td>
      <td class="tg-0pky">-</td>
    </tr>
    <tr>
      <td class="tg-0pky">NERRefiner</td>
      <td class="tg-0pky">NLP</td>
      <td class="tg-0pky">使用命名实体识别（NER）技术识别并屏蔽文本中的特定实体</td>
      <td class="tg-0pky"><a href="https://spacy.io/usage/linguistic-features#named-entities">Code</a></td>
    </tr>
    <tr>
      <td class="tg-0pky">StemmingLemmatizationRefiner</td>
      <td class="tg-0pky">NLP</td>
      <td class="tg-0pky">对文本进行词干提取或词形还原</td>
      <td class="tg-0pky"><a href="https://www.nltk.org/">Code</a></td>
    </tr>
    <tr>
      <td class="tg-0pky">SpellingCorrectionRefiner</td>
      <td class="tg-0pky">NLP、预训练</td>
      <td class="tg-0pky">通过SymSpell对文本中的拼写错误进行纠正</td>
      <td class="tg-0pky"><a href="https://github.com/mammothb/symspellpy">Code</a></td>
    </tr>
    <tr>
      <td class="tg-0pky">RemoveStopwordsRefiner</td>
      <td class="tg-0pky">NLP</td>
      <td class="tg-0pky">移除文本中的停用词（如“the”，“is”）</td>
      <td class="tg-0pky"><a href="https://github.com/nltk/nltk">Code</a></td>
    </tr>
  </tbody>
</table>
</section>
<section id="id4">
<h2>数据去重器<a class="headerlink" href="#id4" title="Link to this heading"></a></h2>
<table class="tg">
  <thead>
    <tr>
      <th class="tg-0pky">名称</th>
      <th class="tg-0pky">适用类型</th>
      <th class="tg-0pky">简介</th>
      <th class="tg-0pky">官方仓库或论文</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td class="tg-0pky">HashDeduplicator</td>
      <td class="tg-0pky">SFT</td>
      <td class="tg-0pky">使用多种哈希函数（如MD5、SHA256、XXH3_128）对文本进行哈希处理，通过精确的比较哈希值来识别和移除重复数据，适用于小规模简单去重场景。</td>
      <td class="tg-0pky">-</td>
    </tr>
    <tr>
      <td class="tg-0pky">CCNetDeduplicator</td>
      <td class="tg-0pky">预训练</td>
      <td class="tg-0pky">基于SHA-1哈希算法的前64位进行比较，以识别重复文本。旨在平衡哈希安全性和计算效率。</td>
      <td class="tg-0pky">-</td>
    </tr>
    <tr>
      <td class="tg-0pky">NgramHashDeduplicator</td>
      <td class="tg-0pky">预训练</td>
      <td class="tg-0pky">结合n-gram技术与哈希算法，将文本分割为多个n-gram片段并分别进行哈希处理。通过多个哈希值的比较来识别相似或重复的文本，适用于处理具有细微差异的重复数据。</td>
      <td class="tg-0pky"><a href="https://arxiv.org/abs/1607.04606">Paper</a></td>
    </tr>
    <tr>
      <td class="tg-0pky">SemDeduplicator</td>
      <td class="tg-0pky">SFT</td>
      <td class="tg-0pky">基于BERT模型的语义相似度计算，通过生成文本的嵌入向量并计算余弦相似度来识别重复内容。适用于需要语义理解的高级去重场景，能够识别语义上相似但表述不同的文本。</td>
      <td class="tg-0pky"><a href="https://arxiv.org/abs/1810.04805">Paper</a> <br> <a href="https://github.com/facebookresearch/SemDeDup">Code</a> </td>
    </tr>
    <tr>
      <td class="tg-0pky">SimHashDeduplicator</td>
      <td class="tg-0pky">预训练</td>
      <td class="tg-0pky">采用SimHash算法，通过生成文本的SimHash指纹并计算汉明距离来判断文本的相似度。适用于高效的相似文本检测，能够快速处理大规模数据集中的重复或相似文本。</td>
      <td class="tg-0pky"><a href="https://dl.acm.org/doi/abs/10.1145/1242572.1242592">Paper</a></td>
    </tr>
    <tr>
      <td class="tg-0pky">MinHashDeduplicator</td>
      <td class="tg-0pky">SFT</td>
      <td class="tg-0pky">结合MinHash与LSH，通过将集合中的元素哈希成一个较小的签名（通常是一个固定长度的整数或比特串），从而以很小的内存占用和低计算成本比较两个集合之间的相似度。</td>
      <td class="tg-0pky"><a href="https://arxiv.org/abs/1811.04633">Paper</a></td>
    </tr>
  </tbody>
</table>
</section>
<section id="id5">
<h2>数据过滤器<a class="headerlink" href="#id5" title="Link to this heading"></a></h2>
<table class="tg">
  <thead>
    <tr>
      <th class="tg-0pky">名称</th>
      <th class="tg-0pky">适用类型</th>
      <th class="tg-0pky">简介</th>
      <th class="tg-0pky">官方仓库或论文</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td class="tg-0pky">LanguageFilter</td>
      <td class="tg-0pky">预训练、SFT</td>
      <td class="tg-0pky">使用fasttext语言识别模型过滤特定语言</td>
      <td class="tg-0pky"><a href="https://huggingface.co/facebook/fasttext-language-identification">Huggingface</a></td>
    </tr>
    <tr>
      <td class="tg-0pky">BlocklistFilter</td>
      <td class="tg-0pky">预训练、SFT</td>
      <td class="tg-0pky">设置阈值，根据List-of-Dirty-Naughty-Obscene-and-Otherwise-Bad-Words屏蔽词表过滤数据点</td>
      <td class="tg-0pky"><a href="https://github.com/LDNOOBW/List-of-Dirty-Naughty-Obscene-and-Otherwise-Bad-Words?tab=readme-ov-file">Code</a></td>
    </tr>
  </tbody>
</table>
<p>同时，作为配套工作，我们支持了Open-DataFlow-Eval文本数据评估模块中基于单个数据点打分器评分的过滤。共18种。</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">DeitaQualityFilter</span><span class="p">:</span>
<span class="w">    </span><span class="nt">min_score</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1</span><span class="w">                                         </span>
<span class="w">    </span><span class="nt">max_score</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">5</span><span class="w">                                     </span>
<span class="w">    </span><span class="nt">scorer_args</span><span class="p">:</span>
<span class="w">      </span><span class="nt">device</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;cuda:0&#39;</span>
<span class="w">      </span><span class="nt">model_name</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;hkust-nlp/deita-quality-scorer&#39;</span>
<span class="w">      </span><span class="nt">max_length</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">512</span>
</pre></div>
</div>
<p>可通过设置需要保留的<code class="docutils literal notranslate"><span class="pre">min/max</span></code>分数并在<code class="docutils literal notranslate"><span class="pre">scorer_args</span></code>中设置打分器参数实现。</p>
<p>支持的打分器，详见<a class="reference internal" href="text_metrics.zh-CN.html"><span class="std std-doc">评估算法文档</span></a>（除Diversity部分）。</p>
<p>此外，启发式规则过滤在预训练数据的筛选方面占有很大的比重，在这一方面，<a class="reference external" href="https://github.com/DataEval/dingo">Dingo数据质量评估工具</a>对我们的开发带来了很大的启发。我们在<code class="docutils literal notranslate"><span class="pre">dataflow/process/text/filters/heuristics.py</span></code>中整合了部分Dingo中使用的规则过滤算法，共22种。详见<a class="reference external" href="https://github.com/DataEval/dingo/blob/dev/docs/rules.md">规则文档</a>，过滤器名称可参考<code class="docutils literal notranslate"><span class="pre">dataflow/process/text/filters/heuristics.py</span></code>文件。</p>
<p>需要说明的是，以上提到的42种数据过滤器具有相同的<code class="docutils literal notranslate"><span class="pre">Yaml</span></code>调用方式。</p>
</section>
</section>


           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; 版权所有 2024, Open-DataFlow。</p>
  </div>

  利用 <a href="https://www.sphinx-doc.org/">Sphinx</a> 构建，使用的 
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">主题</a>
    由 <a href="https://readthedocs.org">Read the Docs</a> 开发.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>